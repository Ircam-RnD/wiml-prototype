'use strict';

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _wavesLfo = require('waves-lfo');

var lfo = _interopRequireWildcard(_wavesLfo);

//import Delta from '../common/lfo-delta';

var _commonLfoIntensity = require('../common/lfo-intensity');

var _commonLfoIntensity2 = _interopRequireDefault(_commonLfoIntensity);

var _commonLfoResampler = require('../common/lfo-resampler');

var _commonLfoResampler2 = _interopRequireDefault(_commonLfoResampler);

var AudioContext = window.AudioContext || window.webkitAudioContext || function () {};

var evin = new lfo.sources.EventIn({
	frameSize: 3,
	ctx: AudioContext
});

// const delta = new Delta({
// 	order: 3,
// 	frameSize: 3
// });

var resampler = new _commonLfoResampler2['default']({
	period: 10
});

var intensity = new _commonLfoIntensity2['default']({});

var rawBpf = new lfo.sinks.Bpf({
	radius: 0,
	min: -500,
	max: 500,
	canvas: document.querySelector('#raw-canvas'),
	duration: 3000,
	colors: ['#f00', '#0c0', '#33f'] // magnitude : Red, frequency : Green, periodicity : Blue
});

var smoothBpf = new lfo.sinks.Bpf({
	radius: 0,
	min: -500,
	max: 500,
	canvas: document.querySelector('#smooth-canvas'),
	duration: 3000,
	colors: ['#f00', '#0c0', '#33f'] // magnitude : Red, frequency : Green, periodicity : Blue
});

// evin.connect(resampler);
// resampler.connect(rawBpf);
// resampler.connect(intensity);

evin.connect(rawBpf);
// evin.connect(delta);
// delta.connect(smoothBpf);
evin.connect(intensity);
intensity.connect(smoothBpf);

// from : http://stackoverflow.com/questions/5916900/how-can-you-detect-the-version-of-a-browser
function getBrowser() {
	var ua = navigator.userAgent,
	    tem,
	    M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
	if (/trident/i.test(M[1])) {
		tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
		return { name: 'IE', version: tem[1] || '' };
	}
	if (M[1] === 'Chrome') {
		tem = ua.match(/\bOPR\/(\d+)/);
		if (tem != null) {
			return { name: 'Opera', version: tem[1] };
		}
	}
	M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];
	if ((tem = ua.match(/version\/(\d+)/i)) != null) {
		M.splice(1, 1, tem[1]);
	}
	return {
		name: M[0],
		version: M[1]
	};
}

//and for os, see : http://stackoverflow.com/questions/9514179/how-to-find-the-operating-system-version-using-javascript

var rads = false;
if (getBrowser().name === 'Chrome') {
	rads = true;
	console.log('switching to rads mode for rotationRate');
}

var txt = document.querySelector('#display-sensor-bounds');
txt.innerHTML = 'not yet initialized ... wait please';

var minx = undefined,
    maxx = undefined,
    miny = undefined,
    maxy = undefined,
    minz = undefined,
    maxz = undefined;
var mingx = undefined,
    maxgx = undefined,
    mingy = undefined,
    maxgy = undefined,
    mingz = undefined,
    maxgz = undefined;
var minra = undefined,
    maxra = undefined,
    minrb = undefined,
    maxrb = undefined,
    minrg = undefined,
    maxrg = undefined;

minx = maxx = miny = maxy = minz = maxz = 0;
mingx = maxgx = mingy = maxgy = mingz = maxgz = 0;
minra = maxra = minrb = maxrb = minrg = maxrg = 0;

//*
if (window.DeviceMotionEvent) {
	console.log('ok');
	evin.start();
	window.addEventListener('devicemotion', function (e) {
		var x = e.acceleration.x;
		var y = e.acceleration.y;
		var z = e.acceleration.z;

		var gx = e.accelerationIncludingGravity.x;
		var gy = e.accelerationIncludingGravity.y;
		var gz = e.accelerationIncludingGravity.z;

		var ra = e.rotationRate.alpha;
		var rb = e.rotationRate.beta;
		var rg = e.rotationRate.gamma;

		if (rads) {
			ra *= 180 / Math.PI;
			rb *= 180 / Math.PI;
			rg *= 180 / Math.PI;
		}

		if (x > maxx) maxx = x;
		if (x < minx) minx = x;
		if (y > maxy) maxy = y;
		if (y < miny) miny = y;
		if (z > maxz) maxz = z;
		if (z < minz) minz = z;

		if (gx > maxgx) maxgx = gx;
		if (gx < mingx) mingx = gx;
		if (gy > maxgy) maxgy = gy;
		if (gy < mingy) mingy = gy;
		if (gz > maxgz) maxgz = gz;
		if (gz < mingz) mingz = gz;

		if (ra > maxra) maxra = ra;
		if (ra < minra) minra = ra;
		if (rb > maxrb) maxrb = rb;
		if (rb < minrb) minrb = rb;
		if (rg > maxrg) maxrg = rg;
		if (rg < minrg) minrg = rg;

		txt.innerHTML = minx + ' ' + maxx + '<br />' + miny + ' ' + maxy + '<br />' + minz + ' ' + maxz + '<br />' + '<br />' + mingx + ' ' + maxgx + '<br />' + mingy + ' ' + maxgy + '<br />' + mingz + ' ' + maxgz + '<br />' + '<br />' + minra + ' ' + maxra + '<br />' + minrb + ' ' + maxrb + '<br />' + minrg + ' ' + maxrg;
		// + '<br />' + navigator;

		//console.log('event !')
		evin.process(performance.now(), [ra, rb, rg]);
	});
} else {
	console.log('not ok');
}
//*/
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9jbGllbnQvc2Vuc29yLXRlc3QvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O3dCQUFxQixXQUFXOztJQUFwQixHQUFHOzs7O2tDQUVPLHlCQUF5Qjs7OztrQ0FDekIseUJBQXlCOzs7O0FBRS9DLElBQUksWUFBWSxHQUFHLE1BQU0sQ0FBQyxZQUFZLElBQUksTUFBTSxDQUFDLGtCQUFrQixJQUFJLFlBQVUsRUFBRSxDQUFDOztBQUVwRixJQUFNLElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQ3BDLFVBQVMsRUFBRSxDQUFDO0FBQ1osSUFBRyxFQUFFLFlBQVk7Q0FDakIsQ0FBQyxDQUFDOzs7Ozs7O0FBT0gsSUFBTSxTQUFTLEdBQUcsb0NBQWM7QUFDL0IsT0FBTSxFQUFFLEVBQUU7Q0FDVixDQUFDLENBQUM7O0FBRUgsSUFBTSxTQUFTLEdBQUcsb0NBQWMsRUFDL0IsQ0FBQyxDQUFDOztBQUVILElBQU0sTUFBTSxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7QUFDaEMsT0FBTSxFQUFFLENBQUM7QUFDVCxJQUFHLEVBQUUsQ0FBQyxHQUFHO0FBQ1QsSUFBRyxFQUFFLEdBQUc7QUFDUixPQUFNLEVBQUUsUUFBUSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUM7QUFDN0MsU0FBUSxFQUFFLElBQUk7QUFDZCxPQUFNLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQztDQUNoQyxDQUFDLENBQUM7O0FBRUgsSUFBTSxTQUFTLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztBQUNuQyxPQUFNLEVBQUUsQ0FBQztBQUNULElBQUcsRUFBRSxDQUFDLEdBQUc7QUFDVCxJQUFHLEVBQUUsR0FBRztBQUNSLE9BQU0sRUFBRSxRQUFRLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDO0FBQ2hELFNBQVEsRUFBRSxJQUFJO0FBQ2QsT0FBTSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUM7Q0FDaEMsQ0FBQyxDQUFDOzs7Ozs7QUFNSCxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDOzs7QUFHckIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUN4QixTQUFTLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDOzs7QUFHN0IsU0FBUyxVQUFVLEdBQUU7QUFDakIsS0FBSSxFQUFFLEdBQUMsU0FBUyxDQUFDLFNBQVM7S0FBQyxHQUFHO0tBQUMsQ0FBQyxHQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsOERBQThELENBQUMsSUFBSSxFQUFFLENBQUM7QUFDaEgsS0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFDO0FBQ3JCLEtBQUcsR0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ3JDLFNBQU8sRUFBQyxJQUFJLEVBQUMsSUFBSSxFQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUUsRUFBRSxBQUFDLEVBQUMsQ0FBQztFQUN2QztBQUNMLEtBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFHLFFBQVEsRUFBQztBQUNmLEtBQUcsR0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFBO0FBQzVCLE1BQUcsR0FBRyxJQUFFLElBQUksRUFBSTtBQUFDLFVBQU8sRUFBQyxJQUFJLEVBQUMsT0FBTyxFQUFFLE9BQU8sRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztHQUFDO0VBQ3ZEO0FBQ0wsRUFBQyxHQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN0RSxLQUFHLENBQUMsR0FBRyxHQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQSxJQUFHLElBQUksRUFBRTtBQUFDLEdBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUFDO0FBQ25FLFFBQU87QUFDTCxNQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNWLFNBQU8sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ2QsQ0FBQztDQUNMOzs7O0FBSUQsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDO0FBQ2pCLElBQUcsVUFBVSxFQUFFLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRTtBQUNsQyxLQUFJLEdBQUcsSUFBSSxDQUFDO0FBQ1osUUFBTyxDQUFDLEdBQUcsQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO0NBQ3ZEOztBQUVELElBQUksR0FBRyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsd0JBQXdCLENBQUMsQ0FBQztBQUMzRCxHQUFHLENBQUMsU0FBUyxHQUFHLHFDQUFxQyxDQUFDOztBQUV0RCxJQUFJLElBQUksWUFBQTtJQUFFLElBQUksWUFBQTtJQUFFLElBQUksWUFBQTtJQUFFLElBQUksWUFBQTtJQUFFLElBQUksWUFBQTtJQUFFLElBQUksWUFBQSxDQUFDO0FBQ3ZDLElBQUksS0FBSyxZQUFBO0lBQUUsS0FBSyxZQUFBO0lBQUUsS0FBSyxZQUFBO0lBQUUsS0FBSyxZQUFBO0lBQUUsS0FBSyxZQUFBO0lBQUUsS0FBSyxZQUFBLENBQUM7QUFDN0MsSUFBSSxLQUFLLFlBQUE7SUFBRSxLQUFLLFlBQUE7SUFBRSxLQUFLLFlBQUE7SUFBRSxLQUFLLFlBQUE7SUFBRSxLQUFLLFlBQUE7SUFBRSxLQUFLLFlBQUEsQ0FBQzs7QUFFN0MsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBQzVDLEtBQUssR0FBRyxLQUFLLEdBQUcsS0FBSyxHQUFHLEtBQUssR0FBRyxLQUFLLEdBQUcsS0FBSyxHQUFHLENBQUMsQ0FBQztBQUNsRCxLQUFLLEdBQUcsS0FBSyxHQUFHLEtBQUssR0FBRyxLQUFLLEdBQUcsS0FBSyxHQUFHLEtBQUssR0FBRyxDQUFDLENBQUM7OztBQUdsRCxJQUFHLE1BQU0sQ0FBQyxpQkFBaUIsRUFBRTtBQUM1QixRQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2xCLEtBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNiLE9BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLEVBQUUsVUFBQyxDQUFDLEVBQUs7QUFDOUMsTUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7QUFDekIsTUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7QUFDekIsTUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7O0FBRXpCLE1BQUksRUFBRSxHQUFHLENBQUMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDLENBQUM7QUFDMUMsTUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLDRCQUE0QixDQUFDLENBQUMsQ0FBQztBQUMxQyxNQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsNEJBQTRCLENBQUMsQ0FBQyxDQUFDOztBQUUxQyxNQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQztBQUM5QixNQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQztBQUM3QixNQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQzs7QUFFOUIsTUFBRyxJQUFJLEVBQUU7QUFDUixLQUFFLElBQUssR0FBRyxHQUFDLElBQUksQ0FBQyxFQUFFLEFBQUMsQ0FBQztBQUNwQixLQUFFLElBQUssR0FBRyxHQUFDLElBQUksQ0FBQyxFQUFFLEFBQUMsQ0FBQztBQUNwQixLQUFFLElBQUssR0FBRyxHQUFDLElBQUksQ0FBQyxFQUFFLEFBQUMsQ0FBQztHQUNwQjs7QUFFRCxNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUN0QixNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUN0QixNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUN0QixNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUN0QixNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUN0QixNQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsSUFBSSxHQUFHLENBQUMsQ0FBQzs7QUFFdEIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDMUIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDMUIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDMUIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDMUIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDMUIsTUFBRyxFQUFFLEdBQUcsS0FBSyxFQUFFLEtBQUssR0FBRyxFQUFFLENBQUM7O0FBRTFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQzFCLE1BQUcsRUFBRSxHQUFHLEtBQUssRUFBRSxLQUFLLEdBQUcsRUFBRSxDQUFDOztBQUUxQixLQUFHLENBQUMsU0FBUyxHQUFHLElBQUksR0FBRyxHQUFHLEdBQUcsSUFBSSxHQUM5QixRQUFRLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxJQUFJLEdBQzVCLFFBQVEsR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLElBQUksR0FBRyxRQUFRLEdBQ3ZDLFFBQVEsR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FDOUIsUUFBUSxHQUFHLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUM5QixRQUFRLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLLEdBQUcsUUFBUSxHQUN6QyxRQUFRLEdBQUcsS0FBSyxHQUFHLEdBQUcsR0FBRyxLQUFLLEdBQzlCLFFBQVEsR0FBRyxLQUFLLEdBQUcsR0FBRyxHQUFHLEtBQUssR0FDOUIsUUFBUSxHQUFHLEtBQUssR0FBRyxHQUFHLEdBQUcsS0FBSyxDQUFDOzs7O0FBSWxDLE1BQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO0VBQzlDLENBQUMsQ0FBQztDQUNILE1BQU07QUFDTixRQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0NBQ3RCIiwiZmlsZSI6InNyYy9jbGllbnQvc2Vuc29yLXRlc3QvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBsZm8gZnJvbSAnd2F2ZXMtbGZvJ1xuLy9pbXBvcnQgRGVsdGEgZnJvbSAnLi4vY29tbW9uL2xmby1kZWx0YSc7XG5pbXBvcnQgSW50ZW5zaXR5IGZyb20gJy4uL2NvbW1vbi9sZm8taW50ZW5zaXR5JztcbmltcG9ydCBSZXNhbXBsZXIgZnJvbSAnLi4vY29tbW9uL2xmby1yZXNhbXBsZXInO1xuXG5sZXQgQXVkaW9Db250ZXh0ID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0IHx8IGZ1bmN0aW9uKCl7fTtcblxuY29uc3QgZXZpbiA9IG5ldyBsZm8uc291cmNlcy5FdmVudEluKHtcblx0ZnJhbWVTaXplOiAzLFxuXHRjdHg6IEF1ZGlvQ29udGV4dFxufSk7XG5cbi8vIGNvbnN0IGRlbHRhID0gbmV3IERlbHRhKHtcbi8vIFx0b3JkZXI6IDMsXG4vLyBcdGZyYW1lU2l6ZTogM1xuLy8gfSk7XG5cbmNvbnN0IHJlc2FtcGxlciA9IG5ldyBSZXNhbXBsZXIoe1xuXHRwZXJpb2Q6IDEwXG59KTtcblxuY29uc3QgaW50ZW5zaXR5ID0gbmV3IEludGVuc2l0eSh7XG59KTtcblxuY29uc3QgcmF3QnBmID0gbmV3IGxmby5zaW5rcy5CcGYoe1xuXHRyYWRpdXM6IDAsXG5cdG1pbjogLTUwMCxcblx0bWF4OiA1MDAsXG5cdGNhbnZhczogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Jhdy1jYW52YXMnKSxcblx0ZHVyYXRpb246IDMwMDAsXG5cdGNvbG9yczogWycjZjAwJywgJyMwYzAnLCAnIzMzZiddIC8vIG1hZ25pdHVkZSA6IFJlZCwgZnJlcXVlbmN5IDogR3JlZW4sIHBlcmlvZGljaXR5IDogQmx1ZVxufSk7XG5cbmNvbnN0IHNtb290aEJwZiA9IG5ldyBsZm8uc2lua3MuQnBmKHtcblx0cmFkaXVzOiAwLFxuXHRtaW46IC01MDAsXG5cdG1heDogNTAwLFxuXHRjYW52YXM6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzbW9vdGgtY2FudmFzJyksXG5cdGR1cmF0aW9uOiAzMDAwLFxuXHRjb2xvcnM6IFsnI2YwMCcsICcjMGMwJywgJyMzM2YnXSAvLyBtYWduaXR1ZGUgOiBSZWQsIGZyZXF1ZW5jeSA6IEdyZWVuLCBwZXJpb2RpY2l0eSA6IEJsdWVcbn0pO1xuXG4vLyBldmluLmNvbm5lY3QocmVzYW1wbGVyKTtcbi8vIHJlc2FtcGxlci5jb25uZWN0KHJhd0JwZik7XG4vLyByZXNhbXBsZXIuY29ubmVjdChpbnRlbnNpdHkpO1xuXG5ldmluLmNvbm5lY3QocmF3QnBmKTtcbi8vIGV2aW4uY29ubmVjdChkZWx0YSk7XG4vLyBkZWx0YS5jb25uZWN0KHNtb290aEJwZik7XG5ldmluLmNvbm5lY3QoaW50ZW5zaXR5KTtcbmludGVuc2l0eS5jb25uZWN0KHNtb290aEJwZik7XG5cbi8vIGZyb20gOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU5MTY5MDAvaG93LWNhbi15b3UtZGV0ZWN0LXRoZS12ZXJzaW9uLW9mLWEtYnJvd3NlclxuZnVuY3Rpb24gZ2V0QnJvd3Nlcigpe1xuICAgIHZhciB1YT1uYXZpZ2F0b3IudXNlckFnZW50LHRlbSxNPXVhLm1hdGNoKC8ob3BlcmF8Y2hyb21lfHNhZmFyaXxmaXJlZm94fG1zaWV8dHJpZGVudCg/PVxcLykpXFwvP1xccyooXFxkKykvaSkgfHwgW107IFxuICAgIGlmKC90cmlkZW50L2kudGVzdChNWzFdKSl7XG4gICAgICAgIHRlbT0vXFxicnZbIDpdKyhcXGQrKS9nLmV4ZWModWEpIHx8IFtdOyBcbiAgICAgICAgcmV0dXJuIHtuYW1lOidJRScsdmVyc2lvbjoodGVtWzFdfHwnJyl9O1xuICAgICAgICB9ICAgXG4gICAgaWYoTVsxXT09PSdDaHJvbWUnKXtcbiAgICAgICAgdGVtPXVhLm1hdGNoKC9cXGJPUFJcXC8oXFxkKykvKVxuICAgICAgICBpZih0ZW0hPW51bGwpICAge3JldHVybiB7bmFtZTonT3BlcmEnLCB2ZXJzaW9uOnRlbVsxXX07fVxuICAgICAgICB9ICAgXG4gICAgTT1NWzJdPyBbTVsxXSwgTVsyXV06IFtuYXZpZ2F0b3IuYXBwTmFtZSwgbmF2aWdhdG9yLmFwcFZlcnNpb24sICctPyddO1xuICAgIGlmKCh0ZW09dWEubWF0Y2goL3ZlcnNpb25cXC8oXFxkKykvaSkpIT1udWxsKSB7TS5zcGxpY2UoMSwxLHRlbVsxXSk7fVxuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBNWzBdLFxuICAgICAgdmVyc2lvbjogTVsxXVxuICAgIH07XG59XG5cbi8vYW5kIGZvciBvcywgc2VlIDogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy85NTE0MTc5L2hvdy10by1maW5kLXRoZS1vcGVyYXRpbmctc3lzdGVtLXZlcnNpb24tdXNpbmctamF2YXNjcmlwdFxuXG5sZXQgcmFkcyA9IGZhbHNlO1xuaWYoZ2V0QnJvd3NlcigpLm5hbWUgPT09ICdDaHJvbWUnKSB7XG5cdHJhZHMgPSB0cnVlO1xuXHRjb25zb2xlLmxvZygnc3dpdGNoaW5nIHRvIHJhZHMgbW9kZSBmb3Igcm90YXRpb25SYXRlJyk7XG59XG5cbmxldCB0eHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGlzcGxheS1zZW5zb3ItYm91bmRzJyk7XG50eHQuaW5uZXJIVE1MID0gJ25vdCB5ZXQgaW5pdGlhbGl6ZWQgLi4uIHdhaXQgcGxlYXNlJztcblxubGV0IG1pbngsIG1heHgsIG1pbnksIG1heHksIG1pbnosIG1heHo7XG5sZXQgbWluZ3gsIG1heGd4LCBtaW5neSwgbWF4Z3ksIG1pbmd6LCBtYXhnejtcbmxldCBtaW5yYSwgbWF4cmEsIG1pbnJiLCBtYXhyYiwgbWlucmcsIG1heHJnO1xuXG5taW54ID0gbWF4eCA9IG1pbnkgPSBtYXh5ID0gbWlueiA9IG1heHogPSAwO1xubWluZ3ggPSBtYXhneCA9IG1pbmd5ID0gbWF4Z3kgPSBtaW5neiA9IG1heGd6ID0gMDtcbm1pbnJhID0gbWF4cmEgPSBtaW5yYiA9IG1heHJiID0gbWlucmcgPSBtYXhyZyA9IDA7XG5cbi8vKlxuaWYod2luZG93LkRldmljZU1vdGlvbkV2ZW50KSB7XG5cdGNvbnNvbGUubG9nKCdvaycpO1xuXHRldmluLnN0YXJ0KCk7XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdkZXZpY2Vtb3Rpb24nLCAoZSkgPT4ge1xuXHRcdGxldCB4ID0gZS5hY2NlbGVyYXRpb24ueDtcblx0XHRsZXQgeSA9IGUuYWNjZWxlcmF0aW9uLnk7XG5cdFx0bGV0IHogPSBlLmFjY2VsZXJhdGlvbi56O1xuXG5cdFx0bGV0IGd4ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lng7XG5cdFx0bGV0IGd5ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lnk7XG5cdFx0bGV0IGd6ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5Lno7XG5cblx0XHRsZXQgcmEgPSBlLnJvdGF0aW9uUmF0ZS5hbHBoYTtcblx0XHRsZXQgcmIgPSBlLnJvdGF0aW9uUmF0ZS5iZXRhO1xuXHRcdGxldCByZyA9IGUucm90YXRpb25SYXRlLmdhbW1hO1xuXG5cdFx0aWYocmFkcykge1xuXHRcdFx0cmEgKj0gKDE4MC9NYXRoLlBJKTtcblx0XHRcdHJiICo9ICgxODAvTWF0aC5QSSk7XG5cdFx0XHRyZyAqPSAoMTgwL01hdGguUEkpO1xuXHRcdH1cblxuXHRcdGlmKHggPiBtYXh4KSBtYXh4ID0geDtcblx0XHRpZih4IDwgbWlueCkgbWlueCA9IHg7XG5cdFx0aWYoeSA+IG1heHkpIG1heHkgPSB5O1xuXHRcdGlmKHkgPCBtaW55KSBtaW55ID0geTtcblx0XHRpZih6ID4gbWF4eikgbWF4eiA9IHo7XG5cdFx0aWYoeiA8IG1pbnopIG1pbnogPSB6O1xuXG5cdFx0aWYoZ3ggPiBtYXhneCkgbWF4Z3ggPSBneDtcblx0XHRpZihneCA8IG1pbmd4KSBtaW5neCA9IGd4O1xuXHRcdGlmKGd5ID4gbWF4Z3kpIG1heGd5ID0gZ3k7XG5cdFx0aWYoZ3kgPCBtaW5neSkgbWluZ3kgPSBneTtcblx0XHRpZihneiA+IG1heGd6KSBtYXhneiA9IGd6O1xuXHRcdGlmKGd6IDwgbWluZ3opIG1pbmd6ID0gZ3o7XG5cblx0XHRpZihyYSA+IG1heHJhKSBtYXhyYSA9IHJhO1xuXHRcdGlmKHJhIDwgbWlucmEpIG1pbnJhID0gcmE7XG5cdFx0aWYocmIgPiBtYXhyYikgbWF4cmIgPSByYjtcblx0XHRpZihyYiA8IG1pbnJiKSBtaW5yYiA9IHJiO1xuXHRcdGlmKHJnID4gbWF4cmcpIG1heHJnID0gcmc7XG5cdFx0aWYocmcgPCBtaW5yZykgbWlucmcgPSByZztcblxuXHRcdHR4dC5pbm5lckhUTUwgPSBtaW54ICsgJyAnICsgbWF4eFxuXHRcdFx0KyAnPGJyIC8+JyArIG1pbnkgKyAnICcgKyBtYXh5XG5cdFx0XHQrICc8YnIgLz4nICsgbWlueiArICcgJyArIG1heHogKyAnPGJyIC8+J1xuXHRcdFx0KyAnPGJyIC8+JyArIG1pbmd4ICsgJyAnICsgbWF4Z3hcblx0XHRcdCsgJzxiciAvPicgKyBtaW5neSArICcgJyArIG1heGd5XG5cdFx0XHQrICc8YnIgLz4nICsgbWluZ3ogKyAnICcgKyBtYXhneiArICc8YnIgLz4nXG5cdFx0XHQrICc8YnIgLz4nICsgbWlucmEgKyAnICcgKyBtYXhyYVxuXHRcdFx0KyAnPGJyIC8+JyArIG1pbnJiICsgJyAnICsgbWF4cmJcblx0XHRcdCsgJzxiciAvPicgKyBtaW5yZyArICcgJyArIG1heHJnO1xuXHRcdFx0Ly8gKyAnPGJyIC8+JyArIG5hdmlnYXRvcjtcblxuXHRcdC8vY29uc29sZS5sb2coJ2V2ZW50ICEnKVxuXHRcdGV2aW4ucHJvY2VzcyhwZXJmb3JtYW5jZS5ub3coKSwgW3JhLCByYiwgcmddKTtcblx0fSk7XG59IGVsc2Uge1xuXHRjb25zb2xlLmxvZygnbm90IG9rJyk7XG59XG4vLyovXG4iXX0=